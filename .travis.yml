language: java

jdk:
  - openjdk8

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: FLwpOE+U/VEqEGHWbWOtb31i5X+W9uK77mxM7MRo9jae0lwsoybdciI6cZ/APuzMdZ28jydTdd5bM063CdnlOaJ02qhUOS1uILEHSUk/xurYtnWPvVFgD9IBE//0JElLJN9wG3RIY9GfB/WtZIJfCzUz06GJ4F5+NEYXRNGCuCZCHU3Kd2t1OTsnoDKv3igA2j+HHj2dvhL2zX+d1HZ9nh4CgV8uwh6XWByHSajYRhCVlayRHth1yoBCskUsSDcwnlrIiEqNwc/ooGJOuqdOv67GUARnvbx3YugLTJ0XUbCjiEhl03wg6ALlbVzgGZ2gzTsLQdGXbawjbiDOrGJsJO8soTcFHwoR6No9Dze2/MGPdKRBYeQeo/troPDRTqYm6YcpvQVNUdwo660UYKWm246m35p494Knc3bx93x0nlcBLumPHz5M4/KXAOveqaRh/QFM4wfMXx4zK12XfGebQ6frLeeb3excGtuokoS4+ZzTbaCK01ORdc9522beHzi2G5wxYu/+G9ZIfKVfOpftaJiIEnizHfG9ffgL5S+WBqHQR5vJrggHUFvuyo23Bp49eR9W3AAjhJXQmLxW9XobUqT4wJYzzAtuF9TRmN1nMxBavqRmXL3Lj1VtlOhKbcJ1XZBpXWypSaFQh8heO0RJzK4fuAauSnamGNKxNzmpEkI=
  file:
    - "spt-development-cid-web-spring-boot-autoconfigure/target/spt-development-cid-web-spring-boot-autoconfigure-${POM_VERSION}.jar"
    - "spt-development-cid-web-spring-boot-starter/target/spt-development-cid-web-spring-boot-starter-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true
