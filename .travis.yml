language: java

jdk:
  - openjdk8

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: vwXbCHpDKS6U+leOSXfNPykFbhTHN5T9zswpnevEDDS2f3HLjmX40X+5z8mlBuMxcpTVelkafDYbBHbrWwkKlioe++QtKmU2M1viHEJ1yreXB70Ig3+kvQYnQnEBJWuYRdO4YdR3RBLvbbroR4b5eTjlEOKTQXhUs4LzETGM7qmtmAaabbhRcchM+vv3XTEsG0QqYWv1lLCSFjmCVaXy5cItHDafFaIGPtYvFMRYQAJCH4tj1LNfJMl6geITVqM0pX8xjfjvCw/yDjolFOKGJ3EL0cbKv4FT3oSRJQxddtu9LN3dGd49GaHqeX3sZoLfP90RxMWybxpwqVcY/c2n9ORgTgatndKl8bbeVEvxYKZbleKOiCvZl5pJK03WNECIvGVQeeAQcHyFafY0DcfFcIO53T6KGgbSGdrXmCyxEUXW65+o9z0j+I/qvrZhJlcOFbowNAYsoceei5AZPhNbwSxg0djitY5Qz5pb75leg/+sQmP1x89oJE2svPi7tZvm8f7M0166b5wgbI5a2yLOlZwg/0s7RUiEAi7JrczropOi5rO8/xFe/AqK4Atzt4i/3Iep9HMrniP1nJUBSY3RkSC1242qwIBpz+XQ9gfBGCcQJMez1NCk+CZo2DVqr3Yy4OOGxMLZ8KOPei7R73oaxsagUKpVn/9r4QJ3EoEqrnU=
  file:
    - "spt-development-cid-web-spring-boot-autoconfigure/target/spt-development-cid-web-spring-boot-autoconfigure-${POM_VERSION}.jar"
    - "spt-development-cid-web-spring-boot-starter/target/spt-development-cid-web-spring-boot-starter-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true
